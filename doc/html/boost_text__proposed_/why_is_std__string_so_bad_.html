<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=US-ASCII">
<title>Why is std::string So Bad?</title>
<link rel="stylesheet" href="../boostbook.css" type="text/css">
<meta name="generator" content="DocBook XSL Stylesheets V1.79.1">
<link rel="home" href="../index.html" title="Chapter&#160;1.&#160;Boost.Text (Proposed)">
<link rel="up" href="../index.html" title="Chapter&#160;1.&#160;Boost.Text (Proposed)">
<link rel="prev" href="intro.html" title="Intro">
<link rel="next" href="an_overview_of_boost_text.html" title="An Overview of Boost.Text">
</head>
<body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
<div class="spirit-nav">
<a accesskey="p" href="intro.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="an_overview_of_boost_text.html"><img src="../images/next.png" alt="Next"></a>
</div>
<div class="section">
<div class="titlepage"><div><div><h2 class="title" style="clear: both">
<a name="boost_text__proposed_.why_is_std__string_so_bad_"></a><a class="link" href="why_is_std__string_so_bad_.html" title="Why is std::string So Bad?">Why is
    std::string So Bad?</a>
</h2></div></div></div>
<h4>
<a name="boost_text__proposed_.why_is_std__string_so_bad_.h0"></a>
      <span class="phrase"><a name="boost_text__proposed_.why_is_std__string_so_bad_.the_fat_interface"></a></span><a class="link" href="why_is_std__string_so_bad_.html#boost_text__proposed_.why_is_std__string_so_bad_.the_fat_interface">The
      Fat Interface</a>
    </h4>
<p>
      Here are the member functions that directly mutate, or allow mutation by returning
      a reference to the internal storage of a <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span></code>,
      not counting overloads, and not counting assignment operators or swap:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
          <code class="computeroutput"><span class="identifier">assign</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">at</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="keyword">operator</span><span class="special">[]()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">front</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">back</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">data</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">begin</span><span class="special">()</span></code>
          (non-<code class="computeroutput"><span class="keyword">const</span></code>)
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">end</span><span class="special">()</span></code>
          (non-<code class="computeroutput"><span class="keyword">const</span></code>)
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">reserve</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">shrink_to_fit</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">clear</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">insert</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">erase</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">push_back</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">pop_back</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">append</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="keyword">operator</span><span class="special">+=()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">replace</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">resize</span><span class="special">()</span></code>
        </li>
</ul></div>
<p>
      That's a lot! Some are semantically synonymous, like <code class="computeroutput"><span class="identifier">data</span><span class="special">()</span></code> and <code class="computeroutput"><span class="identifier">begin</span><span class="special">()</span></code>, or <code class="computeroutput"><span class="identifier">append</span><span class="special">()</span></code> and <code class="computeroutput"><span class="keyword">operator</span><span class="special">+=()</span></code>.
    </p>
<p>
      <code class="computeroutput"><a class="link" href="../boost/text/v1/string.html" title="Struct string">string</a></code>
      has these equivalent member functions (<code class="computeroutput"><span class="keyword">operator</span><span class="special">+=()</span></code> still exists, but as a nonmember):
    </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
          <code class="computeroutput"><span class="keyword">operator</span><span class="special">[]()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">begin</span><span class="special">()</span></code>
          (non-<code class="computeroutput"><span class="keyword">const</span></code>)
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">end</span><span class="special">()</span></code>
          (non-<code class="computeroutput"><span class="keyword">const</span></code>)
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">reserve</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">shrink_to_fit</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">clear</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">insert</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">erase</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">replace</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">resize</span><span class="special">()</span></code>
        </li>
</ul></div>
<p>
      This makes <code class="computeroutput"><a class="link" href="../boost/text/v1/string.html" title="Struct string">string</a></code>
      a type that is much easier to teach, audit, and write static checks for.
    </p>
<p>
      Additionally, <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span></code> has a number of search operations
      that are needlessly implemented as member functions:
    </p>
<div class="itemizedlist"><ul class="itemizedlist" style="list-style-type: disc; ">
<li class="listitem">
          <code class="computeroutput"><span class="identifier">find</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">rfind</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">find_first_of</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">find_first_not_of</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">find_last_of</span><span class="special">()</span></code>
        </li>
<li class="listitem">
          <code class="computeroutput"><span class="identifier">find_last_not_of</span><span class="special">()</span></code>
        </li>
</ul></div>
<p>
      These would have been much more useful as separate algorithms that can be applied
      to any sequence of characters. Implementing these as member functions is the
      moral equivalent of adding a <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">vector</span><span class="special">::</span><span class="identifier">sort</span><span class="special">()</span></code>
      member.
    </p>
<p>
      Boost.Text does not provide these as separate algorithms, because the standard
      algorithms and <a href="https://www.boost.org/doc/libs/1_68_0/doc/html/string_algo.html" target="_top">Boost.StringAlgo</a>.
    </p>
<h4>
<a name="boost_text__proposed_.why_is_std__string_so_bad_.h1"></a>
      <span class="phrase"><a name="boost_text__proposed_.why_is_std__string_so_bad_.the_expensive_substring_operation"></a></span><a class="link" href="why_is_std__string_so_bad_.html#boost_text__proposed_.why_is_std__string_so_bad_.the_expensive_substring_operation">The
      Expensive Substring Operation</a>
    </h4>
<p>
      Since <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">string_view</span></code> was added so long after <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span></code>,
      <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span></code> forms substrings by allocating memory
      in <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span><span class="special">::</span><span class="identifier">substr</span><span class="special">()</span></code>.
      Forming a non-owning substring should be a fundamental operation, and should
      be essentially free.
    </p>
<p>
      Boost.Text provides substring-producing slicing operations that do no copies
      or allocations.
    </p>
<h4>
<a name="boost_text__proposed_.why_is_std__string_so_bad_.h2"></a>
      <span class="phrase"><a name="boost_text__proposed_.why_is_std__string_so_bad_.the_missing_unicode_support"></a></span><a class="link" href="why_is_std__string_so_bad_.html#boost_text__proposed_.why_is_std__string_so_bad_.the_missing_unicode_support">The
      Missing Unicode Support</a>
    </h4>
<p>
      Most humans speak a language that cannot fit in ASCII characters, or in fact
      any one-octet encoding.
    </p>
<p>
      However, <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span></code> lacks any guarantees of any kind that
      its contents are in a particular encoding.
    </p>
<p>
      Boost.Text's types address this by guaranteeing UTF-8 encoding at all times
      for <code class="computeroutput"><a class="link" href="../boost/text/v1/text.html" title="Struct text">text</a></code>
      and its related types. <code class="computeroutput"><a class="link" href="../boost/text/v1/string.html" title="Struct string">string</a></code> and its related types
      are encoding-agnostic.
    </p>
<h4>
<a name="boost_text__proposed_.why_is_std__string_so_bad_.h3"></a>
      <span class="phrase"><a name="boost_text__proposed_.why_is_std__string_so_bad_.miscellaneous_limitations"></a></span><a class="link" href="why_is_std__string_so_bad_.html#boost_text__proposed_.why_is_std__string_so_bad_.miscellaneous_limitations">Miscellaneous
      Limitations</a>
    </h4>
<p>
      Finally, <code class="computeroutput"><span class="identifier">std</span><span class="special">::</span><span class="identifier">string</span></code> is not thread-safe, cannot be implemented
      as copy-on-write, and is contiguous.
    </p>
<p>
      Boost.Text provides <code class="computeroutput"><a class="link" href="../boost/text/v1/unencoded_rope.html" title="Struct unencoded_rope">unencoded_rope</a></code> and <code class="computeroutput"><a class="link" href="../boost/text/v1/rope.html" title="Struct rope">rope</a></code>
      for those times when you want a string type that is thread-safe, copy-on-write,
      or cheap to insert into the middle of.
    </p>
</div>
<table xmlns:rev="http://www.cs.rpi.edu/~gregod/boost/tools/doc/revision" width="100%"><tr>
<td align="left"></td>
<td align="right"><div class="copyright-footer">Copyright &#169; 2018 T. Zachary Laine<p>
        Distributed under the Boost Software License, Version 1.0. (See accompanying
        file LICENSE_1_0.txt or copy at <a href="http://www.boost.org/LICENSE_1_0.txt" target="_top">http://www.boost.org/LICENSE_1_0.txt</a>)
      </p>
</div></td>
</tr></table>
<hr>
<div class="spirit-nav">
<a accesskey="p" href="intro.html"><img src="../images/prev.png" alt="Prev"></a><a accesskey="u" href="../index.html"><img src="../images/up.png" alt="Up"></a><a accesskey="h" href="../index.html"><img src="../images/home.png" alt="Home"></a><a accesskey="n" href="an_overview_of_boost_text.html"><img src="../images/next.png" alt="Next"></a>
</div>
</body>
</html>
